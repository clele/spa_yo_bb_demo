window.demo={Models:{},Collections:{},Views:{},Routers:{},init:function(){"use strict";new demo.Views.NewsView(new Backbone.Model({value:"full"})),new demo.Views.ContactUsView,new demo.Routers.FourThingsRouter,Backbone.history.start()}},$(document).ready(function(){"use strict";$(".slides").bxSlider({minSlides:1,maxSlides:3,slideWidth:960}),$.validator.setDefaults({highlight:function(a){$(a).closest(".form-group").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(a,b){b.parent(".input-group").length?a.insertAfter(b.parent()):a.insertAfter(b)}}),demo.init()}),demo.Models=demo.Models||{},function(){"use strict";demo.Models.ContactModel=Backbone.Model.extend({url:function(){return"api/1.0/contacts"},validate:function(a){return a.name?void 0:"Invalid name."}})}(),demo.Models=demo.Models||{},function(){"use strict";demo.Models.ItemModel=Backbone.Model.extend({url:function(){return"data/"+this.id+".json"},parse:function(a){return a.item}})}(),demo.Views=demo.Views||{},function(){"use strict";demo.Views.NewsView=Backbone.View.extend({el:"#news",initialize:function(a){var b=this;b.state=a,b.state.on("change:value",b.onStateChanged,b),b.$toggleButton=b.$("#cmd_less_more"),b.$newsListItemsMore=b.$("ul li.more")},events:{"click #cmd_less_more":"evtLessOrMore"},evtLessOrMore:function(a){a.preventDefault();var b=this,c=b.state.get("value");"full"===c?b.state.set({value:"less"}):b.state.set({value:"full"})},onStateChanged:function(a){var b=this;"full"===a.get("value")?(b.$newsListItemsMore.slideDown(),b.$toggleButton.text("Show less news")):(b.$newsListItemsMore.slideUp(),b.$toggleButton.text("Show more news"))}})}(),demo.Views=demo.Views||{},function(){"use strict";demo.Views.FourThingsView=Backbone.View.extend({el:"#four_things",initialize:function(){var a=this;a.template=_.template($("#tpl_item").html()),a.cachedItems={},a.$itemContainer=a.$("#current")},setCurrent:function(a){var b=this;b.ensureItem(a).then(function(a){b.currentItem=a,b.renderCurrent()})},ensureItem:function(a){var b=this,c=new jQuery.Deferred;if(a)if(b.cachedItems[a])c.resolve(b.cachedItems[a]);else{var d=new demo.Models.ItemModel({id:a});d.fetch().done(function(){b.cachedItems[a]=d,c.resolve(d)})}else c.reject("invalid item");return c.promise()},renderCurrent:function(){var a=this,b=a.currentItem.attributes,c=a.template(b);a.$itemContainer.empty(),a.$itemContainer.append(c)}})}(),demo.Views=demo.Views||{},function(){"use strict";demo.Views.ContactUsView=Backbone.View.extend({el:"#contact_us",initialize:function(){var a=this;a.$form=a.$("form"),a.$name=a.$("#name"),a.$email=a.$("#email"),a.$phone=a.$("#phone"),a.$form.validate({errorClass:"control-group error",rules:{email:{required:!0,email:!0},phone:{digits:!0,maxlength:11}},debug:!0})},isValid:function(){var a=this;return a.$form.valid()},events:{"submit form":"evtSubmit"},evtSubmit:function(a){a.preventDefault();var b=this;if(b.isValid()){var c=new demo.Models.ContactModel({name:b.$name.val(),email:b.$email.val(),phone:b.$phone.val()});c.save().then(function(){alert("Successfully sent!")}).always(function(){b.$name.val(""),b.$email.val(""),b.$phone.val("")})}}})}(),demo.Routers=demo.Routers||{},function(){"use strict";demo.Routers.FourThingsRouter=Backbone.Router.extend({routes:{"items/:id":"items"},items:function(a){demo.fourThings=demo.fourThings||new demo.Views.FourThingsView({}),demo.fourThings.setCurrent(a)}})}();